<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="FaqDAO">

	<!-- 등록 -->
	<insert id="insertFaq">
		INSERT INTO COMMUNITY
		(COMMU_CAT,COMMU_TITLE,ID,COMMU_CONTENT,COMMU_DATE,FAQ_CAT)
		VALUES(#{commu_cat},#{commu_title},#{id},#{commu_content},NOW(),#{faq_cat})
		<!-- INSERT INTO COMMUNITY (COMMU_CAT,COMMU_TITLE,ID,COMMU_CONTENT,COMMU_DATE,FILES,FAQ_CAT) -->
		<!-- VALUES(#{commu_cat},#{commu_title},#{id},#{commu_content},NOW(),#{files},#{faq_cat}) -->
	</insert>

	<!-- 수정 -->
	<update id="updateFaq">
		UPDATE community SET commu_title=#{commu_title},
		id=#{id},
		commu_content=#{commu_content}, commu_date=NOW(),
		faq_cat=#{faq_cat}
		where commu_no=#{commu_no}
	</update>

	<!-- 삭제 -->
	<delete id="deleteFaq">
		DELETE FROM COMMUNITY WHERE commu_no = #{commu_no}
	</delete>

	<!-- 상세보기 -->
	<select id="getFaq" resultType="community">
		SELECT * FROM COMMUNITY WHERE
		commu_no = #{commu_no}
	</select>

	<!-- 전체목록조회(검색) -->
	<select id="getFaqList" resultType="community">
		SELECT * FROM COMMUNITY WHERE commu_cat = 1
		<if test="searchCondition == 'TITLE' "> AND commu_title LIKE replace(CONCAT('%',
			#{searchKeyword}, '%'),' ','')</if>
		<if test="searchCondition == 'CONTENT' "> AND commu_content LIKE replace(CONCAT('%',
			#{searchKeyword}, '%'),' ','')</if>
		<if test="alignlist == 'zero' "> AND faq_cat = '0' </if>
		<if test="alignlist == 'one' "> AND faq_cat = '1' </if>
		<if test="alignlist == 'two' "> AND faq_cat = '2' </if>
		<if test="alignlist == 'three' "> AND faq_cat = '3' </if>
		<if test="alignlist == 'four' "> AND faq_cat = '4' </if>
		ORDER BY commu_date
		LIMIT 10 OFFSET #{offset}
	</select>

	<!-- 페이징처리 목록갯수 -->
	<select id="totalFaqListCnt" resultType="_int">
		SELECT COUNT(*) FROM COMMUNITY WHERE 1=1 and COMMU_CAT = 1
		<if test="searchCondition == 'TITLE' "> AND commu_title LIKE replace(CONCAT('%',
			#{searchKeyword}, '%'),' ','')</if>
		<if test="searchCondition == 'CONTENT' "> AND commu_content LIKE replace(CONCAT('%',
			#{searchKeyword}, '%'),' ','')</if>
		<if test="alignlist == 'zero' "> AND faq_cat = '0' </if>
		<if test="alignlist == 'one' "> AND faq_cat = '1' </if>
		<if test="alignlist == 'two' "> AND faq_cat = '2' </if>
		<if test="alignlist == 'three' "> AND faq_cat = '3' </if>
		<if test="alignlist == 'four' "> AND faq_cat = '4' </if>
	</select>

</mapper>
